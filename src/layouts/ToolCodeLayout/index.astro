---
// src/layouts/ToolCodeLayout.astro (Redesigned)
import '@/styles/container.scss'
import './index.scss'
import { fetchCodes } from '@/utils/fetchCodes.ts'
import Code from '@/components/Code.astro'

const { frontmatter } = Astro.props

const currentPost = frontmatter.url.split('/').at(-1)

const info = await fetchCodes()
const codes = info[currentPost]?.codes || []

const title = frontmatter.title || info[currentPost]?.chName || info[currentPost]?.enName || currentPost
---

<html lang="zh-CN">
    <head>
        <meta charset="utf-8" />
        <title>Use Algorithm{title ? ` | ${title}` : ''}</title>
        <link href="/favicon.svg" rel="icon" type="image/svg+xml" />
        {
            frontmatter && frontmatter.math && (
                <link
                    rel="stylesheet"
                    href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css"
                    integrity="sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC"
                    crossorigin="anonymous"
                />
            )
        }
        <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
        <div class="page-container">
            <header class="page-header">
                <a href="/" class="home-link" aria-label="返回首页">
                    <!-- 内联你的主页 SVG，这里用一个占位符代替 -->
                    <svg class="main-logo" width="165" height="21" viewBox="0 0 331 42" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.970156 22.16V19.04L17.7702 11L18.9702 13.52L3.85016 20.6L18.9702 27.68L17.7702 30.2L0.970156 22.16ZM294.679 35L305.919 4.4L308.679 5.4L297.439 36L294.679 35ZM312.025 27.68L327.145 20.6L312.025 13.52L313.225 11L330.025 19.04V22.16L313.225 30.2L312.025 27.68Z" fill="black" fill-opacity="0.2"></path><path d="M25.5672 26.656V0.879997H29.5992V27.088C29.5992 29.264 30.6872 30.352 32.8632 30.352H43.2312C45.4072 30.352 46.4952 29.264 46.4952 27.088V0.879997H50.5272V26.656C50.5272 31.552 48.0792 34 43.1832 34H32.9112C28.0152 34 25.5672 31.552 25.5672 26.656Z" fill="#9ED1FF"></path><path d="M56.982 32.8V31.2H66.222C68.062 31.2 68.982 30.2667 68.982 28.4C68.982 26.5067 68.2487 25.44 66.782 25.2L62.022 24.4C58.662 23.84 56.982 22.0133 56.982 18.92C56.982 15.1067 58.982 13.2 62.982 13.2H69.662L71.262 14.4V16H62.942C61.0754 16 60.142 16.9333 60.142 18.8C60.142 20.48 60.9287 21.4533 62.502 21.72L67.262 22.52C70.5687 23.0533 72.222 24.96 72.222 28.24C72.222 32.08 70.1954 34 66.142 34H58.582L56.982 32.8ZM77.462 28V19.2C77.462 15.2 79.462 13.2 83.462 13.2H88.662C92.662 13.2 94.662 15.2 94.662 19.2V24.84H80.662V28.4C80.662 30.2667 81.5954 31.2 83.462 31.2H93.862V32.8L92.262 34H83.462C79.462 34 77.462 32 77.462 28ZM80.662 22.24H91.462V18.8C91.462 16.9333 90.5287 16 88.662 16H83.462C81.5954 16 80.662 16.9333 80.662 18.8V22.24ZM140.435 28.32V4.4H143.635V28.64C143.635 30.48 144.568 31.4533 146.435 31.56V34.32C142.435 34.32 140.435 32.32 140.435 28.32ZM150.665 28V19.2C150.665 15.2 152.665 13.2 156.665 13.2H167.865V36C167.865 40 165.865 42 161.865 42H153.865L152.265 40.8V39.2H161.865C163.732 39.2 164.665 38.2667 164.665 36.4V34H156.665C152.665 34 150.665 32 150.665 28ZM153.865 28.4C153.865 30.2667 154.798 31.2 156.665 31.2H164.665V16H156.665C154.798 16 153.865 16.9333 153.865 18.8V28.4ZM173.946 28V19.2C173.946 15.2 175.946 13.2 179.946 13.2H185.546C189.546 13.2 191.546 15.2 191.546 19.2V28C191.546 32 189.546 34 185.546 34H179.946C175.946 34 173.946 32 173.946 28ZM177.146 28.4C177.146 30.2667 178.08 31.2 179.946 31.2H185.546C187.413 31.2 188.346 30.2667 188.346 28.4V18.8C188.346 16.9333 187.413 16 185.546 16H179.946C178.08 16 177.146 16.9333 177.146 18.8V28.4ZM197.466 34V15.6C198.399 14 200.132 13.2 202.666 13.2H206.666L208.266 14.4V16H203.106C201.986 16 201.172 16.3067 200.666 16.92V34H197.466ZM212.349 9.32V5.56H215.869V9.32H212.349ZM212.509 34V13.2H215.709V34H212.509ZM221.958 28V6.4H225.158V13.2H232.758V16H225.158V28.4C225.158 30.2667 226.091 31.2 227.958 31.2H233.158V32.8L231.558 34H227.958C223.958 34 221.958 32 221.958 28ZM237.782 34V4.4H240.982V13.2H248.982C252.982 13.2 254.982 15.2 254.982 19.2V34H251.782V18.8C251.782 16.9333 250.849 16 248.982 16H240.982V34H237.782ZM261.22 34V13.2H284.82C288.82 13.2 290.82 15.2 290.82 19.2V34H287.62V18.8C287.62 16.9333 286.686 16 284.82 16H277.62V34H274.42V16H264.42V34H261.22Z" fill="black"></path><path d="M108.12 33.136L118.968 0.879997H125.592L136.44 33.136L135.864 34H132.552L129.816 25.648H114.744L112.008 34H108.696L108.12 33.136ZM115.944 22H128.616L122.856 4.528H121.704L115.944 22Z" fill="#4FD96E"></path></svg>
                </a>
                <a href="https://github.com/qiutongxue/use-algorithm-site" target="_blank" rel="noopener noreferrer" class="github-link"></a>
            </header>
            <main class="main-content">
                <article>
                    <header class="content-header">
                        <h1 class="title">{title}</h1>
                        <p class="subtitle">{frontmatter.subtitle}</p>
                    </header>
                    <div class="prose">
                        <slot />
                    </div>
                    {codes.length > 0 && <Code groups={codes} />}
                </article>
            </main>
        </div>
    </body>
</html>

<style is:global>
    /* 引入和主页一致的全局变量和基础样式 */
    :root {
        --bg-color: #f8f9fa;
        --card-bg: #ffffff;
        --text-color: #343a40;
        --subtle-text-color: #6c757d;
        --border-color: #dee2e6;
        --accent-color: #9ED1FF;
        --accent-color-dark: #82b9e5;
        --green-accent: #4FD96E;
        --shadow-color: rgba(0, 0, 0, 0.05);

        --code-bg: #fdfdfe;
        --code-title-color: #495057;
        --code-border-color: #e9ecef;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        margin: 0;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .page-container {
        max-width: 820px;
        margin: 0 auto;
        padding: 0 1rem;
    }

    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 2rem 0;
        margin-bottom: 2rem;
        border-bottom: 1px solid var(--border-color);
    }

    .home-link {
        display: block;
    }

    .main-logo {
        height: 24px;
        width: auto;
    }
    
    .github-link {
        display: block;
        width: 28px;
        height: 28px;
        background-image: var(--icon-github); /* 确保 iconVars 中有此变量 */
        background-size: contain;
        background-repeat: no-repeat;
        opacity: 0.6;
        transition: opacity 0.3s ease;

        &:hover {
            opacity: 1;
        }
    }
    
    .main-content {
        padding-bottom: 8rem;
    }

    .content-header {
        margin-bottom: 2.5rem;
    }

    .title {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--text-color);
        margin: 0 0 0.5rem;
        line-height: 1.2;
    }

    .subtitle {
        font-size: 1.25rem;
        color: var(--subtle-text-color);
        margin: 0;
    }

    /* 正文内容的排版 */
    .prose {
        font-size: 1rem;
        line-height: 1.7;
        color: var(--text-color);

        h2 { margin-top: 2.5em; margin-bottom: 1em; }
        h3 { margin-top: 2em; margin-bottom: 1em; }
        p { margin-bottom: 1.25em; }
        a { color: var(--accent-color-dark); text-decoration: none; }
        a:hover { text-decoration: underline; }
        code {
            background-color: rgba(158, 209, 255, 0.2);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
            font-family: "SF Mono", "Menlo", "Monaco", Consolas, monospace;
        }
    }

    @import '../../styles/iconVars.css';
</style>